<html>

<head>
  <title>Vertex Medixlab</title>
  <!-- Replace "../build.js" with the super-hands and
         A-Frame distributions to run : -->
  <script src="../build.js"></script>
  <!-- <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script> -->
  <!-- <script src="https://unpkg.com/super-hands/dist/super-hands.min.js"></script> -->

  <!-- Networked aframe -->

  <script>
    let url ="../../js/structureEntitiesProcess2.json"
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.slim.js"></script>
  <script src="/easyrtc/easyrtc.js"></script>
  <script src="/dist/networked-aframe.js"></script>
  <script src="https://unpkg.com/aframe-particle-system-component@1.0.5/dist/aframe-particle-system-component.min.js"></script>
  <script src="/js/spawn-in-circle.component.js"></script>


  <!-- Super hands -->
  <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.js"></script>
  <script src="https://unpkg.com/aframe-physics-extras/dist/aframe-physics-extras.min.js"></script>
  <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  
  <!-- ownership transfer dependencies -->

  <script src="../../js/spawner.component.js"></script>
  <script src="../../js/toggle-physics.component.js"></script>
  <script src="../../js/rotator.component.js"></script>
  <script src="../../js/input.component.js"></script>
  <script src="../../js/avatar-body.component.js"></script>
  <script src="../../js/camera-output.js"></script>
  <script src="../../js/hand-attach.js"></script>
  <script src="../../js/attach-point.js"></script>
  <script src="../../js/set-name.component.js"></script>
  <script src="../../js/randomize-spec-color.component.js"></script>
  <script src="../../js/Animation-Trigger.js"></script>





  <!-- <script>
    AFRAME.registerComponent('attach-point', {
      init: function() {
        var el = this.el;
        this.el.addEventListener('collide', function(e) {
          console.log('Syringe has collided with ', e.detail.body.el);
          e.detail.body.el.setAttribute('constraint','target: #sphere1');
        });
      }
    })
  </script>
  <script>
    let obj; 
    AFRAME.registerComponent('hand-attach', {
      init: function() {
        var el = this.el;
        this.el.addEventListener('collide', function(e) {
          console.log('Hand has collided with ', e.detail.body.el);
          obj = e.detail.body.el;
        });
        this.el.addEventListener('buttondown', function(e){
          console.log('Grip Down');
          obj.setAttribute('dynamic-body','mass:5');
          obj.removeAttribute('constraint');
        });
        this.el.addEventListener('buttonup', function(e){
          console.log('Grip Up');
          // obj.removeAttribute('constraint');
          obj=0;
        });
      }
    })
  </script> -->
  <script>
    AFRAME.registerComponent('attach-point-axis', {
      init: function() {
        var el = this.el;
        this.el.addEventListener('collide', function(e) {
          let attachRubber = document.getElementById('vxr-rubber');
          let attachBag = document.getElementById('vxr-bag');
          console.log('Cube has collided with ', e.detail.body.el);
          if(e.detail.body.el==attachRubber){
            e.detail.body.el.setAttribute('constraint','type: coneTwist; target: #box1; pivot: 0 0 0; targetPivot: 0 0.0 0.05; axis: 0.0 0.0 -1.0; targetAxis: 1.0 0.0 0.0');
          }if(e.detail.body.el==attachBag){
            // let staticDisposable = document.getElementById('xvr-disposable');
            let animDisposable = document.getElementById('disposableAnim');
            e.detail.body.el.setAttribute('constraint','type: coneTwist; target: #box2; pivot: 0 0 0; targetPivot: -0.03 0.0 0; axis: 1.0 0.0 0.0; targetAxis: 1.0 0.0 0.0');
            // staticDisposable.remove();
            // animDisposable.setAttribute('visible','true');
            // animDisposable.setAttribute('animation-mixer','loop: once; clampWhenFinished: true; timeScale: 0.5');

          }
        });
      }
    })
  </script>
  <script>
    AFRAME.registerComponent('foo', {
      init: function() {
        var el = this.el;
        this.el.addEventListener('collide', function(e) {
          console.log('Cube has collided with ', e.detail.body.el);
          let attachDisposable = document.getElementById('xvr-disposable');
          if(attachDisposable == e.detail.body.el){
            e.detail.body.el.setAttribute('constraint','target: #vxr-bag');
          }
        });
      }
    })
  </script>

<script>
  AFRAME.registerComponent('foo2', {
    init: function() {
      var el = this.el;
      this.el.addEventListener('collide', function(e) {
        let cathter02 = document.getElementById('catheter002');
        let intracathcap02 = document.getElementById('intracathcap002');
        let intracathcap03 = document.getElementById('intracathcap003');
        if(cathter02 == e.detail.body.el){
          intracathcap02.setAttribute('visible','false');
          intracathcap02.remove();
          intracathcap03.setAttribute('visible','true');
          intracathcap03.setAttribute('dynamic-body','mass: 0.1');
          cathter02.remove();
        }
      });
    }
  })
</script>

<script>
  AFRAME.registerComponent('foo3', {
    init: function() {
      var el = this.el;
      this.el.addEventListener('collide', function(e) {
        let intracathcap03 = document.getElementById('intracathcap003');
        if(intracathcap03 == e.detail.body.el){
          intracathcap03.setAttribute('visible','false');
          intracathcap03.remove();
        }
      });
    }
  })
</script>
<script>
  AFRAME.registerComponent('foo4', {
    init: function() {
      var el = this.el;
      this.el.addEventListener('collide', function(e) {
        let bag = document.getElementById('vxr-bag');
        let serumCard = document.getElementById('serumcontrolcard01');
        if(bag == e.detail.body.el){
          serumCard.setAttribute('constraint','target: #vxr-bag');
          
        }
      });
    }
  })
</script>

<script>
  function randomizeColor (target) {
    target.setAttribute('color','#'+Math.random().toString(16).substr(-6));
    // color randomizer credit: http://stackoverflow.com/a/7638362
  }
  function paintBall (evt) {
    let sphere = document.getElementById('sphere2');
    sphere.setAttribute('opacity', '1');
  }
  function unPaintBall (evt) {
    let sphere = document.getElementById('sphere2');
    sphere.setAttribute('opacity', '0');
  }
  function mass (evt) {
    let cathter02 = document.getElementById('catheter02');
    cathter02.setAttribute('dynamic-body', 'mass: 0.1'); 
  }
  function massTape01 (evt) {
    let cathter02 = document.getElementById('tape01');
    cathter02.setAttribute('dynamic-body', 'mass: 0.1');
  }

</script>

<script>
  AFRAME.registerComponent('input', {
    schema: {
      triggerKeyCode: {default: 32} // spacebar
  },
  init: function() {
  var that = this;
  let sphere = document.getElementById("sphere2");
  document.body.onkeyup = function(e){
  if(e.keyCode == that.data.triggerKeyCode){
    console.log("input ------------");
    sphere.setAttribute('opacity','1');
  }
}
}
  })
</script>

  <script>
    function spawnentity() {    

      let syncs = document.getElementsByClassName("syncup");
      for (let i = 0; i < syncs.length; ++i) {
        syncs[i].setAttribute("networked", "template:#vxr-obj-template-catheter02;attachTemplateToLocal:true")
      }
    }
  </script> 
  <link rel="stylesheet" type="text/css" href="../assets/examples.css">
</head>

<body>
  <a-scene physics="debug: false; gravity: -4; iterations: 75" networked-scene="
      room: process2;
      adapter: easyrtc;
      audio: true;
      debug: true;
      onConnect: spawnentity;
    ">
    <a-assets>
      <!-- <a-asset-item id="htc" src="../assets/vr_controller_vive.obj"></a-asset-item> -->
      <a-asset-item id="maskn95" src="../../Models/gltf/MaskN95.gltf"></a-asset-item>
      <a-asset-item id="table" src="../../Models/gltf/Table.gltf"></a-asset-item>
      <a-asset-item id="alcoholbottle" src="../../Models/gltf/AlcoholBottle.gltf"></a-asset-item>
      <a-asset-item id="bed" src="../../Models/gltf/Bed.gltf"></a-asset-item>
      <a-asset-item id="patient" src="../../Models/gltf/Patient.gltf"></a-asset-item>
      <a-asset-item id="tray" src="assets/Tray.gltf"></a-asset-item>
      <a-asset-item id="StudentAvatar" src="assets/StudentNurseAvatar.gltf"></a-asset-item>
      <a-asset-item id="SpectatorAvatar" src="assets/avatars/SpectatorAvatar.gltf"></a-asset-item>
      <a-asset-item id="TeacherAvatar" src="assets/TeacherAvatar.gltf"></a-asset-item>
      <a-asset-item id="right-hand" src="assets/rightHandHigh.glb"></a-asset-item>
      <a-asset-item id="left-hand" src="assets/leftHandHigh.glb"></a-asset-item>
      <a-asset-item id="dripbag" src="../../Models/gltf/DripBag.gltf"></a-asset-item>
      <a-asset-item id="rubber" src="../../Models/gltf/Rubber.gltf"></a-asset-item>
      <a-asset-item id="medicaltape" src="../../Models/gltf/MedicalTape.gltf"></a-asset-item>
      <a-asset-item id="gauze" src="../../Models/gltf/Gauze.gltf"></a-asset-item>
      <a-asset-item id="allistweezers" src="../../Models/gltf/Scisors.gltf"></a-asset-item>
      <a-asset-item id="cottonswab" src="../../Models/gltf/CottonSwabs01.gltf"></a-asset-item>
      <a-asset-item id="salinebottle" src="../../Models/gltf/ClorhexidinaBottle.gltf"></a-asset-item>
      <!-- <a-asset-item id="alcoholgel" src="../../Models/gltf/AlcoholGel.gltf"></a-asset-item> -->
      <a-asset-item id="heparinseal" src="../../Models/gltf/HeparinSeal.gltf"></a-asset-item>
      <a-asset-item id="intracath" src="../../Models/gltf/Intracath.gltf"></a-asset-item>

      <!-- Avatars -->
      <a-asset-item id="StudentAvatarHead" src="assets/avatars/StudentAvatarHead.gltf"></a-asset-item>
      <a-asset-item id="StudentAvatarBody" src="assets/avatars/StudentAvatarBody.gltf"></a-asset-item>
      <a-asset-item id="TeacherAvatarHead" src="assets/avatars/TeacherAvatarHead.gltf"></a-asset-item>
      <a-asset-item id="TeacherAvatarBody" src="assets/avatars/TeacherAvatarBody.gltf"></a-asset-item>
      <a-asset-item id="student" src="assets/StudentNurseAvatar.gltf"></a-asset-item>
      <a-asset-item id="teacher" src="assets/TeacherAvatar.gltf"></a-asset-item>

      <!-- Theater -->
      <a-asset-item id="scenebase" src="/Models/gltf/Scene_Base.gltf"></a-asset-item>
      <a-asset-item id="scenemedixlablogo" src="/Models/gltf/Scene_Medixlablogo.gltf"></a-asset-item>
      <a-asset-item id="sceneieproeslogo" src="/Models/gltf/Scene_Ieproesblogo.gltf"></a-asset-item>
      <a-asset-item id="scenevertexlogo" src="/Models/gltf/Scene_VertexLogo.gltf"></a-asset-item>
      <a-asset-item id="scenebase02" src="/Models/gltf/Base_Auditorium.gltf"></a-asset-item>
      <a-asset-item id="stairsprincipal" src="/Models/gltf/Stairs_Auditorium.gltf"></a-asset-item>
      <a-asset-item id="ministairs" src="/Models/gltf/Mini_Stairs_Auditorium.gltf"></a-asset-item>
      <a-asset-item id="roofauditorium" src="/Models/gltf/Roof_Auditorium.gltf"></a-asset-item>
      <a-asset-item id="columns" src="/Models/gltf/Columns_Auditorium.gltf"></a-asset-item>
      <a-asset-item id="frontwall" src="/Models/gltf/FrontWall_Auditorium.gltf"></a-asset-item>
      <a-video id="canalizacion" src="/videos/Test.mp4" autoplay loop="true"></a-video>
      <a-video id="logopng" src="/Models/Images/Ieproes_Logo.png"></a-video>

      <!-- Catheter -->
t
      <a-asset-item id="catheter01" src="../../Models/gltf/Catheter01.gltf"></a-asset-item>
      <a-asset-item id="catheter02" src="../../Models/gltf/Catheter02.gltf"></a-asset-item>
      <a-asset-item id="disposable" src="../../Models/gltf/Disposable.gltf"></a-asset-item>
      <a-asset-item id="disposable01" src="../../Models/gltf/Disposable01.gltf"></a-asset-item>
      <a-asset-item id="disposableanim" src="../../Models/gltf/DisposableAnim.gltf"></a-asset-item>
      <a-asset-item id="tape001" src="../../Models/gltf/Tape01.gltf"></a-asset-item>
      <a-asset-item id="tape002" src="../../Models/gltf/Tape02.gltf"></a-asset-item>
      <a-asset-item id="tape003" src="../../Models/gltf/Tape03.gltf"></a-asset-item>
      <a-asset-item id="tapestatic001" src="../../Models/gltf/TapeStatic01.gltf"></a-asset-item>
      <a-asset-item id="tapestatic002" src="../../Models/gltf/TapeStatic02.gltf"></a-asset-item>
      <a-asset-item id="tapestatic003" src="../../Models/gltf/TapeStatic03.gltf"></a-asset-item>
      <a-asset-item id="medicalclothe" src="../../Models/gltf/MedicalClothe.gltf"></a-asset-item>
      <a-asset-item id="trashcontainer" src="../../Models/gltf/TrashContainer.gltf"></a-asset-item>
      <a-asset-item id="trashcontainerblack" src="../../Models/gltf/TrashContainerBlack.gltf"></a-asset-item>
      <a-asset-item id="scissorbuttoned" src="../../Models/gltf/Scissor_Buttoned.gltf"></a-asset-item>
      <a-asset-item id="controlcard" src="../../Models/gltf/ControlCard.gltf"></a-asset-item>
      <a-asset-item id="serumcontrolcard" src="../../Models/gltf/SerumControlCard.gltf"></a-asset-item>
      <a-asset-item id="boxsharpobject" src="../../Models/gltf/Box_SharpObject.gltf"></a-asset-item>
      <a-asset-item id="intracathcap01" src="../../Models/gltf/Intracath_Cap_01.gltf"></a-asset-item>
      <a-asset-item id="intracathcap02" src="../../Models/gltf/Intracath_Cap_02.gltf"></a-asset-item>
      <a-asset-item id="intracathcap03" src="../../Models/gltf/Intracath_Cap_03.gltf"></a-asset-item>
      <a-asset-item id="tapeadultdate" src="../../Models/gltf/Tape_Adult_Date.gltf"></a-asset-item>
      <a-asset-item id="cottonpink" src="../../Models/gltf/Cotton_Pink.gltf"></a-asset-item>

      <canvas id="cam2"></canvas>

      <a-asset-item id="base" src="/Models/gltf/Base.gltf"></a-asset-item>

      <a-mixin id="touch" physics-collider phase-shift collision-filter="collisionForces: false"
        static-body="shape: sphere; sphereRadius: 0.02" super-hands="colliderEvent: collisions;
                          colliderEventProperty: els;
                          colliderEndEvent: collisions;
                          colliderEndEventProperty: clearedEls;">
      </a-mixin>
      <a-mixin id="point" raycaster="showLine: true; objects: .vxr-interact" collision-filter="collisionForces: false"
        static-body="shape: sphere; sphereRadius: 0.001" super-hands="colliderEvent: raycaster-intersection;
                    colliderEventProperty: els;
                    colliderEndEvent:raycaster-intersection-cleared;
                    colliderEndEventProperty: clearedEls;"></a-mixin>

      <!-- Player -->
      <template id="player-template">
        <a-entity  networked-audio-source="positional:false"></a-entity>
      </template>
      ​
      <!-- Nurse Avatar -->
      <template id="student-avatar-template">
        <a-entity class="NurseHeadAvatar" gltf-model="#StudentAvatar" position="0 2 0"  networked-audio-source="positional:false"></a-entity>

      </template>

      <!-- Teacher Avatar -->
      <template id="teacher-avatar-template">
        <a-entity class="SpectatorAvatar" gltf-model="#TeacherAvatar" scale="0.8 0.8 0.8" networked-audio-source="positional:false">
        </a-entity>
      </template>

      <!-- Spectator Avatar -->
      <template id="spectator-avatar-template">
        <a-entity class="SpectatorAvatar" gltf-model="#SpectatorAvatar" networked-audio-source="positional:false">
        </a-entity>
      </template>

      <!-- Teacher Avatar Constraints -->
      <template id="constraint-teacher-avatar-template">
        <a-entity>
          <a-entity class="name-up-teacher"></a-entity>
          <a-entity class="TeacherAvatar" id="teacher" gltf-model="#teacher"></a-entity>
        </a-entity>
      </template>

      <!-- Student Avatar Constraints -->
      <template id="constraint-student-avatar-template">
        <a-entity>
          <a-entity class="name-up-student"></a-entity>
          <a-entity class="StudentAvatar" id="student" gltf-model="#student"></a-entity>
        </a-entity>
      </template>

      <!-- Spectator Avatar Constraints -->
      <template id="constraint-spectator-avatar-template">
        <a-entity>
          <a-entity class="name-up"></a-entity>
          <a-entity class="SpectatorAvatar" id="spectator" gltf-model="#SpectatorAvatar"></a-entity>
      </template>

      <!-- Right Hand -->
      <template id="right-hand-template">
        <a-entity>
          <a-entity scale="0.8 0.8 0.8" gltf-model="#right-hand"></a-entity>
        </a-entity>
      </template>

      <!-- Left Hand -->
      <template id="left-hand-template">
        <a-entity>
          <a-entity scale="0.8 0.8 0.8" gltf-model="#left-hand"></a-entity>
        </a-entity>
      </template>

      <!-- vxr-template -->
      <template id="vxr-template">
        <a-entity>
          <a-box class="vxr-obj-a" rotator="speed:-2" width="0.35" height="0.35" depth="0.35" rotation="0 0 0"
            color="green" position="0 0 0"></a-box>
          <a-sphere class="vxr-obj-b" toggle-physics color="#f00" dynamic-body draggable grabbable radius="0.18"
            position="0.5 0 0"></a-sphere>
          <a-box class="vxr-obj-c" rotator="speed:2" color="blue" width="0.35" height="0.35" depth="0.35"
            position="1 0 0"></a-box>
        </a-entity>
      </template>

      <!-- vxr-gltf -->

      <template id="vxr-obj-template">
        <a-entity>          
          <a-entity class="vxr-obj-maskn95 vxr-interact" gltf-model="#controlcard" draggable grabbable toggle-physics position="-0.19696 0.44217 -0.17021" ratation="0 0 0"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-2">
        <a-entity>
          <a-entity class="vxr-obj-alcoholbottle vxr-interact" gltf-model="#alcoholbottle" draggable grabbable
            toggle-physics position="-0.14496 0.40887 -0.00538"></a-entity>            
        </a-entity>
      </template>

      <template id="vxr-obj-template-3">
        <a-entity>
          <a-entity class="vxr-obj-tray vxr-interact" gltf-model="#tray" 
          position="0.16568 0.39627 -0.04338"></a-entity>
        </a-entity>
      </template>
      <template id="vxr-obj-template-4">
        <a-entity>
          <a-entity id="vxr-rubber" class="vxr-obj-rubber vxr-interact" gltf-model="#rubber" toggle-physics draggable grabbable
          position="0.26935 0.46445 -0.03337" scale="0.8 0.8 0.8"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-dripbag">
        <a-entity>
          <a-entity id="vxr-bag" class="vxr-obj-dripbag vxr-interact" foo gltf-model="#dripbag" draggable grabbable
            toggle-physics position="-0.48483 0.66406 -0.19693" rotation="0 0 0"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-medicaltape">
        <a-entity>
          <a-entity class="vxr-obj-medicaltape vxr-interact" gltf-model="#medicaltape" draggable grabbable
            toggle-physics position="-0.35446 0.40724 -0.18029"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-gauze">
        <a-entity>
          <a-entity id="vxr-gauze" class="vxr-obj-gauze vxr-interact" gltf-model="#gauze"  position="0.05969 0.42035 -0.06898"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-allistweezers">
        <a-entity>
          <a-entity class="vxr-obj-allistweezers vxr-interact" gltf-model="#scissorbuttoned" draggable
            grabbable toggle-physics position="-0.54393 0.41195 -0.36544"  rotation="0 0 0"></a-entity>            
        </a-entity>
      </template>

      <template id="vxr-obj-template-cottonswab01">
        <a-entity>
          <a-entity class="vxr-obj-cottonswab01 vxr-interact" gltf-model="#cottonpink" draggable grabbable
            toggle-physics position="0.07984 0.42445 -0.0597"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-cottonswab02">
        <a-entity>
          <a-entity class="vxr-obj-cottonswab02 vxr-interact" gltf-model="#cottonswab" draggable grabbable
            toggle-physics position="0.06158 0.42445 -0.08856"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-cottonswab03">
        <a-entity>
          <a-entity class="vxr-obj-cottonswab03 vxr-interact" gltf-model="#cottonswab" draggable grabbable
            toggle-physics position="0.04329 0.42445 -0.05698"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-salinebottle">
        <a-entity>
          <a-entity class="vxr-obj-salinebottle vxr-interact" gltf-model="#salinebottle" draggable
            grabbable toggle-physics position="-0.27603 0.4056 0.00447"></a-entity>            
        </a-entity>
      </template>

      <!-- <template id="vxr-obj-template-alcoholgel">
        <a-entity>
          <a-entity class="vxr-obj-alcoholgel vxr-interact" gltf-model="#alcoholgel" draggable grabbable
            toggle-physics position="-0.42543 0.40645 -0.00552"></a-entity>            
        </a-entity>
      </template> -->

      <template id="vxr-obj-template-heparinseal">
        <a-entity>
          <a-entity class="vxr-obj-heparinseal vxr-interact" gltf-model="#heparinseal" draggable grabbable
            toggle-physics position="-1.57 0.50 10"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-intracath">
        <a-entity>
          <a-entity id="vxr-intracath" class="vxr-obj-intracath vxr-interact" gltf-model="#intracath" draggable grabbable
            toggle-physics position="0.36424 0.43148 -0.02905"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-catheter01">
        <a-entity>
          <a-entity id="catheter001" class="vxr-obj-catheter01" gltf-model="#catheter01" rotation="-42.646394607177434 0 0" position="0.88826 0.33653 -0.54233" scale="1 1 1" visible="false"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-catheter02">
        <a-entity>
          <a-entity id="catheter002" class="vxr-obj-catheter02" gltf-model="#catheter02" 
          rotation="-42.38397993700752 0 0" 
          position="0.88793 0.35024 -0.52707"
          scale="1 1 1" 
          visible="false" 
          draggable grabbable
          ondragstart="mass(event)" 
        ></a-entity>
        </a-entity>
      </template>
    
      <template id="vxr-obj-template-disposable">
        <a-entity>
          <a-entity id="xvr-disposable" class="vxr-obj-disposable" gltf-model="#disposable" position="0.04419 0.42407 -0.31558" scale="1 1 1" visible="true" draggable grabbable toggle-physics></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-disposableanim">
        <a-entity>
          <a-entity id="disposableAnim" animation-mixer="timeScale:0" class="vxr-obj-disposableanim" gltf-model="#disposableanim" position="0.25505 0.60746 -1.4154" scale="1 1 1" visible="false"></a-entity>
        </a-entity>
      </template>
      
      <template id="vxr-obj-template-tape01">
        <a-entity>
          <a-entity id="tape01" class="vxr-obj-tape01" gltf-model="#tapestatic001" position="0.54179 0.398 -0.347" rotation="0 0 0" scale="1 1 1" visible="true" dynamic-body="mass: 0" draggable grabbable ondragstart="mass(event)"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-tape02">
        <a-entity>
          <a-entity id="tape02" class="vxr-obj-tape02" gltf-model="#tapestatic002" position="0.54179 0.399 -0.262" rotation="0 0 0" scale="1 1 1" visible="true" dynamic-body="mass: 0" draggable grabbable ondragstart="mass(event)"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-tape03">
        <a-entity>
          <a-entity id="tape03" class="vxr-obj-tape02" gltf-model="#tapestatic003" position="0.54179 0.397 -0.184" rotation="0 0 0" scale="1 1 1" visible="true" dynamic-body="mass: 0" draggable grabbable ondragstart="mass(event)"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-medicalclothe">
        <a-entity>
          <a-entity id="medicalclothe01" class="vxr-obj-medicalclothe" gltf-model="#medicalclothe" position="0.3564 0.43682 -0.39681" rotation="0 90 0" scale="1 1 1" visible="true" draggable grabbable dynamic-body="mass: 0"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-medicalclothestatic">
        <a-entity>
          <a-entity id="medicalclothe02" class="vxr-obj-medicalclothestatic" gltf-model="#medicalclothe" position="0.92743 0.29114 -0.64739" rotation="0 90 0" scale="1 1 1" visible="false" draggable grabbable></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-tapestatic01">
        <a-entity>
          <a-entity id="tapestatic01" class="vxr-obj-tapestatic01" gltf-model="#tapestatic001" position="0.89304 0.325 -0.564" rotation="0 0 3.000579973100121" scale="1 1 1" visible="false"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-tapestatic02">
        <a-entity>
          <a-entity id="tapestatic02" class="vxr-obj-tapestatic02" gltf-model="#tapestatic002" position="0.88925 0.326 -0.55128" rotation="-5.777706406099221 -0.7717741500412189 7.624349379805865" scale="1 1 1" visible="false"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-tapestatic03">
        <a-entity>
        <a-entity id="tapestatic03" class="vxr-obj-tapestatic03" gltf-model="#tapestatic003" position="0.88943 0.32572 -0.55393" rotation="0 0 5.940426419916375" scale="1 1 1" visible="false"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-serumcontrolcard">
        <a-entity>
        <a-entity id="serumcontrolcard01" class="vxr-obj-serumcontrolcard" foo4 gltf-model="#serumcontrolcard" draggable grabbable toggle-physics position="-0.40045 0.4232 -0.38062" rotation="0 0 0" scale="1 1 1" visible="true"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-boxsharpobject">
        <a-entity>
        <a-entity id="serumcontrolcard01" class="vxr-obj-boxsharpobject" gltf-model="#boxsharpobject" position="0.309 -0.228 -0.424" rotation="0 180 0" scale="0.6 0.6 0.6" visible="true"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-intracathcap01">
        <a-entity>
        <a-entity id="intracathcap001" class="vxr-obj-intracathcap01" gltf-model="#intracathcap01" position="0.364 0.423 -0.023" rotation="0 0 0" scale="1 1 1" visible="true"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-intracathcap02">
        <a-entity>
        <a-entity id="intracathcap002" class="vxr-obj-intracathcap02" gltf-model="#intracathcap02" position="0.897 0.273 -0.059" rotation="0 180 0" scale="1 1 1" visible="true" static-body foo2></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-intracathcap03">
        <a-entity>
        <a-entity id="intracathcap003" class="vxr-obj-intracathcap03" gltf-model="#intracathcap03" position="0.897 0.273 -0.059" rotation="0 180 0" scale="1 1 1" visible="false" dynamic-body="mass: 0.0" draggable grabbable></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-tapeadult">
        <a-entity>
        <a-entity id="tapeadult" class="vxr-obj-tapeadult" gltf-model="#tapeadultdate" position="0.54179 0.398 -0.094" rotation="0 180 0" scale="1 1 1" visible="true" dynamic-body="mass: 0.0" draggable grabbable ondragstart="mass(event)"></a-entity>
        </a-entity>
      </template>

      <template id="vxr-obj-template-tapeadultstatic">
        <a-entity>
        <a-entity id="tapeadultstatic" class="vxr-obj-tapeadultstatic" gltf-model="#tapeadultdate" position="0.892 0.327 -0.568" rotation="0 0 0" scale="1 1 1" visible="false"></a-entity>
        </a-entity>
      </template>

      <template id="audience">
        <a-entity id="spectator" position="-2.9119 2.18025 -2.79791" assign-seat>
          <a-entity id="constraint-spectator" camera look-controls>
            <a-entity class="name-up" name-up></a-entity>
          </a-entity>
        </a-entity>
      </template>

    </a-assets>

    <a-entity environment="lightPosition: 1 5 -2; groundColor: #00275b; grid: dots; gridColor: #168dab; preset: starry; skyType: atmosphere; skyColor: #030022; playArea: 0.5; ground: flat; groundColor2: #009dff" visible="">
      <a-entity class="environment" position="0 50 0"></a-entity>
      <a-entity class="environment" position="1 5 -2" light="intensity: 0.1" visible=""></a-entity>
      <a-entity class="environmentDressing environment" visible="false"></a-entity>
      <a-sky radius="200" theta-length="110" class="environment" material="shader: skyshader; sunPosition: 0 0 0" visible="" geometry=""></a-sky>
      <a-entity class="environment" position="0 50 0"></a-entity>
      <a-entity class="environment" position="1 5 -2" light="intensity: 0.1" visible=""></a-entity>
      <a-entity rotation="-90 0 0" class="environmentGround environment" visible="" scale="1 1 3"></a-entity>
      <a-entity class="environmentDressing environment" visible="false"></a-entity>
      <a-sky radius="200" theta-length="110" class="environment" material="shader: skyshader; sunPosition: 0 0 0" visible="" geometry=""></a-sky>
    </a-entity>
    <a-light id="directionallight" light="intensity: 0.2" type="directional" position="0 0 0" rotation="-90 0 0" intensity="0.400" target="#directionaltarget">
      <a-entity id="directionaltarget" position="0 0 -1"></a-entity>
    </a-light>

    <!-- Static Objects -->
    
    <!-- <a-entity id="tstTable" class="gltf" gltf-model="#table" position="-1.5 0.99273 -0.363"   rotation="0 180 0"></a-entity> -->
    <a-entity id="patient01" gltf-model="#patient" scale="" position="1.13143 1.87016 0.12594"   material="color: brown"  ></a-entity> 

    <a-entity class="gltf" gltf-model="#table" position="-0.13 1 -0.363" rotation="0 180 0"></a-entity>
    <a-entity class="gltf" gltf-model="#bed" position="1.2 1 -0.67251" rotation="0 0 0"></a-entity>
    <a-box opacity="0" static-body rotation="" position="-0.10703 1.85724 -0.36937" color="red" depth="0.6" height="0.1" width="1.1"></a-box>
    <a-box opacity="0" static-body rotation="0 90 0" position="1.19381 1.75704 -0.20298" color="red" depth="0.8" height="0.02 " width="1.1"></a-box>
    <a-box opacity="0" static-body rotation="0 90 0" position="0.17639 1.90605 -0.24462" color="red" depth="0.47" height="0.02" width="0.35"></a-box>
    <a-box opacity="0" static-body rotation="0 0 0" position="0.53699 1.86541 -0.42932" color="red" depth="0.33" height="0.02" width="0.11"></a-box>
    <a-box opacity="0" static-body rotation="0 0 0" position="0.290 1.273 -0.581" color="red" depth="0.33" height="0.02" width="0.31" foo3></a-box>



    <!-- Theater Objects -->
    <a-entity id="frontwall01" gltf-model="#frontwall" scale="1 1 1" position="0 0 -1.12569" material="color: brown" rotation="0 0 0"></a-entity>
    <a-entity id="roofauditorium01" gltf-model="#roofauditorium" scale="1 1 1" position="0 1.35517 0" material="color: brown" rotation="0 0 0"></a-entity>
    <a-entity id="scenebase01" gltf-model="#scenebase" scale="1 1 1" position="0 -0.82 0" material="color: brown" rotation="0 0 0"></a-entity>
    <a-entity id="scenebase02" gltf-model="#scenebase02" scale="1 1 1" position="0 0 0" material="color: brown" rotation="0 0 0"></a-entity>
    <a-entity id="scenemedixlablogo01" gltf-model="#scenemedixlablogo" scale="2 2 2" position="0.04036 11.22773 -2.14313" material="color: brown" rotation="0 0 0"></a-entity>
    <a-entity id="sceneieproeslogo01" gltf-model="#sceneieproeslogo" scale="3 3 3" position="-7.3502 9.07108 11.32697" material="color: brown" rotation="0 151.70203541678805 0"></a-entity>
    <a-entity id="scenevertexlogo01" gltf-model="#scenevertexlogo" scale="1 1 1" position="7.21432 9.20078 11.49686" material="color: brown" rotation="0 -146.36321468175908 0"></a-entity>
    <a-entity id="stairsprincipal01" gltf-model="#stairsprincipal" scale="1 1 1" position="0 0 0" rotation="0 0 0"></a-entity>
    <a-entity id="ministairs01" gltf-model="#ministairs" scale="1 1 1" position="0 0 0" rotation="0 0 0"></a-entity>
    <a-entity id="lamps03" gltf-model="#lamps01" scale="1 1 1" position="0 16.9716 0" rotation="0 0 0"></a-entity>
    <a-entity id="columns01" gltf-model="#columns" scale="1 1 1" position="0 0 0" material="color: brown" rotation="0 0 0"></a-entity>
    <a-entity id="base" gltf-model="/Models/gltf/Base.gltf" scale="" position="0.42223 1 -1.62523" material="color: brown" rotation=""></a-entity>

    <!-- Theater Lights -->
    <a-entity background="color: #92f2ff"></a-entity>

    <a-entity light="intensity: 0.7; type: ambient" position="-2.02939 0.34443 -0.50913" rotation="0 180 0" id="ambientlight"></a-entity>
    <a-entity light="color: #ffffff; penumbra: 0.81; type: point; intensity: 0.2" id="light01" position="-1.11051 9.99225 4.03024" rotation="-90 0 0"></a-entity>

    <a-entity id="player" networked="template:#player-template;attachTemplateToLocal:false;" position="0 0.8 -2"
      rotation="0 180 0" movement-controls="speed:0.3">
      <a-entity camera position="0 1.6 0.2" look-controls input
        networked="template:#constraint-teacher-avatar-template;attachTemplateToLocal:false;">
      </a-entity>
      <!-- /VIVE CONTROLLERS -->
      <a-entity id="lhand" mixin="touch" hand-attach input-controls="hand: left" networked="template:#left-hand-template">
      </a-entity>
      <a-entity id="rhand" mixin="touch" hand-attach input-controls="hand: right" networked="template:#right-hand-template">
      </a-entity>
    </a-entity>
    
    <a-sphere id="sphere1" static-body attach-point opacity="0" position="0.89964 1.79244 -0.77085" color="black" radius="0.03"></a-sphere>
    <a-sphere id="sphere2" static-body attach-point opacity="0" position="0.92743 1.79311 -0.8472" color="black" radius="0.06"></a-sphere>
    <a-box id="box1" attach-point-axis opacity="0" static-body rotation="8.133135901882035 -21.810784387245047 -3.2406492892599363" position="0.93988 1.81863 -0.98812" color="red" depth="0.03" height="0.03" width="0.03"></a-box>
    <a-box id="box2" attach-point-axis opacity="0" static-body rotation="0 0 0" position="0.281 2.60882 -1.62308" color="red" depth="0.03" height="0.03" width="0.03"></a-box>
  
    <a-entity id="xvr-trashcontainer" gltf-model="#trashcontainerblack" position="0.60795 0.98577 -0.0845" scale="0.49177 0.49177 0.49177" visible="true"></a-entity>
    <a-entity id="xvr-trashcontainer" gltf-model="#trashcontainer" position="0.60795 0.98577 -0.4343" scale="0.49177 0.49177 0.49177" visible="true"></a-entity>
    <!-- <a-sphere id="sphere2" static-body attach-point opacity="0"  position="0.93508 1.85 -1" color="black" radius="0.03"></a-sphere> -->
    
     <!-- <a-entity id="catheter001" gltf-model="#catheter01" rotation="-42.646394607177434 0 0" position="0.91343 1.83446 -0.80194" scale="1 1 1" visible="false"></a-entity>
      <a-entity id="catheter002" gltf-model="#catheter02" 
      rotation="-42.38397993700752 0 0" 
      position="0.91343 1.85175 -0.78297"
      scale="1 1 1" 
      visible="false" 
      draggable grabbable
      ondragstart="mass(event)" 
    ></a-entity>
    <a-entity id="xvr-disposable" gltf-model="#disposable" position="0 2 -0.5" scale="1 1 1" visible="true" draggable grabbable dynamic-body></a-entity>
    <a-entity id="disposableAnim" gltf-model="#disposableanim"  position="0.2792 2.10794 -1.67224" scale="1 1 1" visible="false"></a-entity>  -->
    <!-- <a-entity id="disposable02" gltf-model="#disposable01"  position="0.35183 2.35042 -1.5712" scale="1 1 1" visible="true"></a-entity> -->
    <!-- <a-box id="box1" attach-point-axis opacity="1" static-body rotation="20 0 0" position="0.93508 1.85 -1.03" color="red" depth="0.03" height="0.03" width="0.03"></a-box> -->
    <!-- <a-sphere id="sphere1" static-body foo opacity="0" position="0.92 1.85 -0.35" color="black" radius="0.03"></a-sphere> -->
    <!-- ground collider keeps objets from falling -->
    <!-- <a-box constraint="target: #patient01;"  geometry="width: 1; depth: 1" dynamic-body scale="0.1 0.1 0.1" position="1.20136 4 -0.71331" /> -->
    <!-- <a-box id="boxTST" constraint="target: #patient01; type: lock; maxForce: 10" position="1.2 5 -0.7" scale="0.1 0.1 0.1" dynamic-body /> -->

    <!-- <a-box static-body width="100" height="0.01" depth="100" visible="false"></a-box> -->

  </a-scene>
 
  <script>
    // Define custom schema for syncing avatar color, set by random-color
    NAF.schemas.add({
      template: '#student-avatar-template',
      components: [
        'position',
        'rotation'
      ]
    });
    NAF.schemas.add({
      template: '#teacher-avatar-template',
      components: [
        'position',
        'rotation'
      ]
    });
    NAF.schemas.add({
      template: '#spectator-avatar-template',
      components: [
        'position',
        'rotation'
      ]
    });
    NAF.schemas.add({
      template: '#constraint-spectator-avatar-template',
      components: [
        'position',
        'rotation',
        {
          selector: '.name-up',
          component: 'name-up'
        },
        {
          selector: '.SpectatorAvatar',
          component: 'randomize-spec-color'
        }
      ]
    });
    NAF.schemas.add({
      template: '#constraint-teacher-avatar-template',
      components: [
        'position',
        'rotation'
      ]
    });
    NAF.schemas.add({
      template: '#constraint-student-avatar-template',
      components: [
        'position',
        'rotation'
      ]
    });
    NAF.schemas.add({
      template: '#player-template',
      components: [
        'position',
        'rotation',
      ]
    });
    NAF.schemas.add({
      template: '#right-hand-template',
      components: [
        'position',
        'rotation'
      ]
    });
    NAF.schemas.add({
      template: '#left-hand-template',
      components: [
        'position',
        'rotation'
      ]
    });
    NAF.schemas.add({
      template: '#vxr-obj-template-catheter02',
      components: [
        'position',
        'rotation',
        {
          selector: '.vxr-obj-catheter02',
          property: 'visible'
        }
      ]
    });

    //Called by Networked-Aframe when connected to server
    function onConnect() {
      console.log("funca");
    }
  </script>
  <script src="../../js/Feature-SpawnTemplate.js"></script>

  <script src="../../js/Feature-SpawnObjects.js"></script>
  <script src="../../js/vxr-full-house.js"></script>

  <script src="../../js/Feature-Schemas.js"></script>



</body>

</html>